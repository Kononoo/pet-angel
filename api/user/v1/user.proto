syntax = "proto3";

package api.user.v1;

import "google/api/annotations.proto";

option go_package = "pet-angel/api/user/v1;v1";

// 用户关系与主页服务
// - 关注/取关：当前登录用户对目标用户的关系
// - 主页：展示用户基础资料与最近的帖子
// - 列表：关注列表、点赞过的帖子列表
service UserService {
  // 关注用户
  rpc FollowUser(FollowUserRequest) returns (FollowUserReply) {
    option (google.api.http) = { post: "/v1/user/follow" body: "*" };
  }
  // 取消关注
  rpc UnfollowUser(UnfollowUserRequest) returns (UnfollowUserReply) {
    option (google.api.http) = { post: "/v1/user/unfollow" body: "*" };
  }
  // 用户主页信息
  rpc GetUserProfile(GetUserProfileRequest) returns (GetUserProfileReply) {
    option (google.api.http) = { get: "/v1/user/{user_id}/profile" };
  }
  // 关注列表（用户关注的人）
  rpc GetFollowList(GetFollowListRequest) returns (GetFollowListReply) {
    option (google.api.http) = { get: "/v1/user/{user_id}/follows" };
  }
  // 点赞列表（用户点赞过的帖子）
  rpc GetLikeList(GetLikeListRequest) returns (GetLikeListReply) {
    option (google.api.http) = { get: "/v1/user/{user_id}/likes" };
  }g
}

// 关注请求
message FollowUserRequest {
  int64 target_user_id = 1; // 目标用户ID（必填，>0）
}
message FollowUserReply {
  // 是否成功
  bool success = 1;
}

// 取消关注请求
message UnfollowUserRequest {
  int64 target_user_id = 1; // 目标用户ID（必填，>0）
}
message UnfollowUserReply {
  // 是否成功
  bool success = 1;
}

// 帖子简要信息（用于主页/点赞列表）
message PostBrief {
  // 帖子ID
  int64 id = 1;
  // 标题（可为空）
  string title = 2;
  // 帖子类型：0=图文 1=视频
  int32 post_type = 3;
  // 封面URL（可为空）
  string cover_url = 4;
  // 点赞数
  int32 liked_count = 5;
  // 创建时间 YYYY-MM-DD HH:MM:SS
  string created_at = 6;
}

// 用户主页请求
message GetUserProfileRequest {
  int64 user_id = 1; // 目标用户ID（必填，>0）
}

// 用户主页响应
message GetUserProfileReply {
  // 头像URL
  string avatar = 1;
  // 昵称
  string nickname = 2;
  // 宠物名称
  string pet_name = 3;
  // 宠物性别 0未知/1男/2女
  int32 pet_sex = 4;
  // 宠物品类
  string kind = 5;
  // 体重(kg)
  int32 weight = 6;
  // 爱好
  string hobby = 7;
  // 简介
  string description = 8;
  // 最近的帖子（按时间倒序，条数由服务端控制）
  repeated PostBrief posts = 9;
  // 当前登录用户是否已关注该用户
  bool is_followed = 10;
}

// 用户简要
message UserBrief {
  // 用户ID
  int64 id = 1;
  // 昵称
  string nickname = 2;
  // 头像URL
  string avatar = 3;
}

// 关注列表请求
message GetFollowListRequest {
  int64 user_id = 1;  // 目标用户ID（必填，>0）
  int32 page = 2;     // 页码，从1开始（默认1）
  int32 page_size = 3;// 每页条数（默认20，最大100）
}
message GetFollowListReply {
  // 总条数
  int32 total = 1;
  // 关注列表
  repeated UserBrief list = 2;
}

// 点赞列表请求
message GetLikeListRequest {
  int64 user_id = 1;  // 目标用户ID（必填，>0）
  int32 page = 2;     // 页码，从1开始（默认1）
  int32 page_size = 3;// 每页条数（默认20，最大100）
}
message GetLikeListReply {
  // 总条数
  int32 total = 1;
  // 点赞过的帖子列表
  repeated PostBrief list = 2;
}